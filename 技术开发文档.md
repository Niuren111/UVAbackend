# 无人机行业网站技术开发文档

## 一、系统架构设计

### 1. 整体架构
- 采用微服务架构
  - 用户服务（认证、授权）
  - 招聘服务（职位、简历）
  - 任务服务（运输任务）
  - 培训服务（机构、课程）
  - 订票服务（航班、订座）
  - 商城服务（商品、订单）
  - 支付服务
  - 消息服务
  - 文件服务

### 2. 技术选型
#### 2.1 前端技术栈
- 框架：React 18
- 状态管理：Redux Toolkit
- UI组件库：Ant Design
- 构建工具：Vite
- 路由：React Router 6
- 请求库：Axios
- 地图服务：高德地图API
- WebSocket：Socket.io-client

#### 2.2 后端技术栈
- 主框架：Spring Cloud
- 服务注册与发现：Nacos
- 网关：Spring Cloud Gateway
- 认证授权：Spring Security + JWT
- 缓存：Redis
- 消息队列：RabbitMQ
- 搜索引擎：Elasticsearch
- 文件存储：阿里云OSS
- 数据库：MySQL + MongoDB

#### 2.3 部署架构
- 容器化：Docker
- 编排工具：Kubernetes
- 负载均衡：Nginx
- CI/CD：Jenkins
- 监控：Prometheus + Grafana
- 日志：ELK Stack

## 二、数据库设计

### 1. 关系型数据库（MySQL）
#### 1.1 用户相关
```sql
-- 用户表
CREATE TABLE users (
    id BIGINT PRIMARY KEY,
    username VARCHAR(50) NOT NULL,
    password VARCHAR(100) NOT NULL,
    phone VARCHAR(20),
    email VARCHAR(100),
    real_name VARCHAR(50),
    id_card VARCHAR(20),
    avatar_url VARCHAR(200),
    user_type TINYINT,
    status TINYINT,
    created_at DATETIME,
    updated_at DATETIME
);

-- 企业信息表
CREATE TABLE companies (
    id BIGINT PRIMARY KEY,
    company_name VARCHAR(100) NOT NULL,
    license_no VARCHAR(50),
    legal_person VARCHAR(50),
    company_size VARCHAR(50),
    industry VARCHAR(50),
    description TEXT,
    logo_url VARCHAR(200),
    status TINYINT,
    created_at DATETIME,
    updated_at DATETIME
);
```

#### 1.2 招聘相关
```sql
-- 职位表
CREATE TABLE jobs (
    id BIGINT PRIMARY KEY,
    company_id BIGINT,
    title VARCHAR(100) NOT NULL,
    description TEXT,
    requirements TEXT,
    salary_min INT,
    salary_max INT,
    location VARCHAR(100),
    job_type TINYINT,
    experience VARCHAR(50),
    education VARCHAR(50),
    status TINYINT,
    created_at DATETIME,
    updated_at DATETIME
);

-- 简历表
CREATE TABLE resumes (
    id BIGINT PRIMARY KEY,
    user_id BIGINT,
    title VARCHAR(100),
    education TEXT,
    experience TEXT,
    skills TEXT,
    certificates TEXT,
    status TINYINT,
    created_at DATETIME,
    updated_at DATETIME
);
```

#### 1.3 任务相关
```sql
-- 运输任务表
CREATE TABLE transport_tasks (
    id BIGINT PRIMARY KEY,
    publisher_id BIGINT,
    title VARCHAR(200),
    description TEXT,
    start_location VARCHAR(100),
    end_location VARCHAR(100),
    cargo_type VARCHAR(50),
    weight DECIMAL(10,2),
    budget DECIMAL(10,2),
    deadline DATETIME,
    status TINYINT,
    created_at DATETIME,
    updated_at DATETIME
);
```

### 2. 非关系型数据库（MongoDB）
#### 2.1 商品数据
```javascript
// 商品集合
{
    _id: ObjectId,
    name: String,
    category: String,
    brand: String,
    price: Number,
    description: String,
    specifications: Object,
    images: Array,
    stock: Number,
    sales: Number,
    ratings: Number,
    status: Number,
    createdAt: Date,
    updatedAt: Date
}
```

#### 2.2 订单数据
```javascript
// 订单集合
{
    _id: ObjectId,
    userId: String,
    orderNo: String,
    items: Array,
    totalAmount: Number,
    status: Number,
    paymentMethod: String,
    paymentStatus: Number,
    shippingAddress: Object,
    createdAt: Date,
    updatedAt: Date
}
```

## 三、API接口设计

### 1. RESTful API 规范
- 使用HTTP方法表示操作类型
- 使用HTTP状态码表示请求结果
- 使用JWT进行身份认证
- 支持API版本控制
- 实现请求限流和熔断

### 2. 主要接口定义
#### 2.1 用户服务
```
POST /api/v1/auth/register     # 用户注册
POST /api/v1/auth/login        # 用户登录
GET /api/v1/users/profile      # 获取用户信息
PUT /api/v1/users/profile      # 更新用户信息
```

#### 2.2 招聘服务
```
POST /api/v1/jobs              # 发布职位
GET /api/v1/jobs               # 获取职位列表
GET /api/v1/jobs/{id}          # 获取职位详情
POST /api/v1/resumes           # 投递简历
```

#### 2.3 任务服务
```
POST /api/v1/tasks             # 发布任务
GET /api/v1/tasks              # 获取任务列表
POST /api/v1/tasks/{id}/bid    # 投标
GET /api/v1/tasks/{id}/status  # 获取任务状态
```

## 四、前端架构设计

### 1. 项目结构
```
src/
├── assets/          # 静态资源
├── components/      # 公共组件
├── hooks/           # 自定义hooks
├── layouts/         # 布局组件
├── pages/           # 页面组件
├── services/        # API服务
├── store/           # 状态管理
├── utils/           # 工具函数
└── App.tsx          # 根组件
```

### 2. 状态管理
```typescript
// 用户状态示例
interface UserState {
    currentUser: User | null;
    token: string | null;
    loading: boolean;
    error: string | null;
}

// 任务状态示例
interface TaskState {
    tasks: Task[];
    currentTask: Task | null;
    loading: boolean;
    error: string | null;
}
```

### 3. 路由配置
```typescript
const routes = [
    {
        path: '/',
        component: Layout,
        children: [
            {
                path: '/jobs',
                component: JobList,
                auth: true
            },
            {
                path: '/tasks',
                component: TaskList,
                auth: true
            }
        ]
    }
];
```

## 五、安全设计

### 1. 身份认证
- JWT token认证
- 密码加密存储
- 登录失败限制
- Session管理

### 2. 数据安全
- HTTPS传输加密
- 敏感数据加密
- SQL注入防护
- XSS防护
- CSRF防护

### 3. 权限控制
- RBAC权限模型
- API访问控制
- 数据访问控制
- 操作日志记录

## 六、性能优化

### 1. 前端优化
- 路由懒加载
- 组件按需加载
- 图片懒加载
- 资源压缩
- 浏览器缓存

### 2. 后端优化
- 数据库索引优化
- 缓存策略
- 连接池管理
- 异步处理
- 分库分表

### 3. 部署优化
- CDN加速
- 负载均衡
- 服务器集群
- 数据库主从
- 缓存集群

## 七、监控告警

### 1. 系统监控
- 服务器监控
- 应用监控
- 数据库监控
- 缓存监控
- 日志监控

### 2. 业务监控
- 用户行为分析
- 业务指标监控
- 异常监控
- 性能监控

### 3. 告警机制
- 监控指标定义
- 告警规则配置
- 告警方式（短信、邮件、钉钉）
- 告警级别划分

## 八、部署方案

### 1. 环境规划
- 开发环境
- 测试环境
- 预发布环境
- 生产环境

### 2. 部署架构
```
                        [CDN]
                          ↓
                      [Nginx]
                          ↓
        [Spring Cloud Gateway + Nacos]
                          ↓
    ┌─────────┬─────────┬─────────┬─────────┐
    ↓         ↓         ↓         ↓         ↓
[用户服务] [招聘服务] [任务服务] [商城服务] [支付服务]
    ↓         ↓         ↓         ↓         ↓
    └─────────┴─────────┴─────────┴─────────┘
                          ↓
                [MySQL + Redis + MongoDB]
```

### 3. CI/CD流程
1. 代码提交
2. 自动化测试
3. 代码审查
4. 自动构建
5. 自动部署
6. 监控验证 